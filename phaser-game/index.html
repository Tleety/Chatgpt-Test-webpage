<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <link rel="icon" href="../favicon.svg" type="image/svg+xml">
  <title>Snake Game</title>
  <link rel="stylesheet" href="../style.css">
  <script src="https://cdn.jsdelivr.net/npm/phaser@3/dist/phaser.js"></script>
  <style>
    main { 
      text-align: center; 
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: calc(100vh - 60px); /* Account for header height */
      justify-content: center;
      padding: 20px;
    }
    #game { 
      margin: 20px auto;
      display: inline-block;
    }
  </style>
</head>
<body>
  <header class="top-bar">
    <img src="../favicon.svg" alt="Site logo" class="logo">
    <span class="title">My GitHub Page</span>
  </header>
  <main>
    <h1>Snake Game</h1>
    <p>Use the arrow keys to move the snake and eat the red squares. Don't run into the walls or yourself!</p>
    <div id="game"></div>
  </main>
  <script>
    const CELL_SIZE = 20;
    let cursors;
    const config = {
      type: Phaser.AUTO,
      width: 800,
      height: 600,
      backgroundColor: '#000',
      parent: 'game',
      scene: {
        create,
        update
      }
    };

    function create() {
      this.snake = [];
      this.direction = { x: CELL_SIZE, y: 0 };
      cursors = this.input.keyboard.createCursorKeys();
      this.score = 0;
      this.scoreText = this.add.text(10, 10, 'Score: 0', { font: '20px Arial', fill: '#fff' });

      const startX = Math.floor(config.width / 2 / CELL_SIZE) * CELL_SIZE;
      const startY = Math.floor(config.height / 2 / CELL_SIZE) * CELL_SIZE;
      const head = this.add.rectangle(startX, startY, CELL_SIZE, CELL_SIZE, 0x00ff00).setOrigin(0);
      this.snake.push(head);

      this.food = this.add.rectangle(0, 0, CELL_SIZE, CELL_SIZE, 0xff0000).setOrigin(0);
      placeFood.call(this);

      this.time.addEvent({ delay: 150, callback: move, callbackScope: this, loop: true });
    }

    function update() {
      if (cursors.left.isDown && this.direction.x === 0) {
        this.direction = { x: -CELL_SIZE, y: 0 };
      } else if (cursors.right.isDown && this.direction.x === 0) {
        this.direction = { x: CELL_SIZE, y: 0 };
      } else if (cursors.up.isDown && this.direction.y === 0) {
        this.direction = { x: 0, y: -CELL_SIZE };
      } else if (cursors.down.isDown && this.direction.y === 0) {
        this.direction = { x: 0, y: CELL_SIZE };
      }
    }

    function move() {
      const head = this.snake[0];
      const newX = head.x + this.direction.x;
      const newY = head.y + this.direction.y;

      if (newX < 0 || newX >= config.width || newY < 0 || newY >= config.height ||
          this.snake.some(seg => seg.x === newX && seg.y === newY)) {
        this.scene.restart();
        return;
      }

      const newHead = this.add.rectangle(newX, newY, CELL_SIZE, CELL_SIZE, 0x00ff00).setOrigin(0);
      this.snake.unshift(newHead);

      if (newX === this.food.x && newY === this.food.y) {
        placeFood.call(this);
        this.score += 1;
        this.scoreText.setText('Score: ' + this.score);
      } else {
        const tail = this.snake.pop();
        tail.destroy();
      }
    }

    function placeFood() {
      let x, y;
      do {
        x = Math.floor(Math.random() * config.width / CELL_SIZE) * CELL_SIZE;
        y = Math.floor(Math.random() * config.height / CELL_SIZE) * CELL_SIZE;
      } while (this.snake.some(seg => seg.x === x && seg.y === y));
      this.food.setPosition(x, y);
    }

    new Phaser.Game(config);
  </script>
</body>
</html>
